<ui:composition xmlns="https://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	template="../templates/imsTemplate.xhtml">
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!-- Tab title defined -->
	<ui:define name="title">
			IMS - Purchase Order
		</ui:define>

	<!-- Title appearing in top left of the page -->
	<ui:define name="pagetitle">
			Purchase Order
		</ui:define>

	<!-- Breadcrumbs appearing in top right of the page -->
	<ui:define name="breadcrumbs">
		<a href="imsIndex.xhtml">Home</a> > Purchase Orders
		</ui:define>

	<ui:define name="backFunction">
		<h:commandLink action="#{pos.reset()}" value="" class="hovering">
			<h:graphicImage class="glass_back" value="../img/back.png" />
		</h:commandLink>
	</ui:define>

	<!-- Operations buttons - add/edit/delete -->
	<ui:define name="addbtn">
		<h:form>
			<h:commandLink action="#{pos.goToAddPOPage()}"
				value="Add New Purchase Order">
				<img src="../img/add.png" class="icon opsicon" />
			</h:commandLink>
		</h:form>
	</ui:define>

	<ui:define name="searchButtonAction">
		<h:commandLink class="hovering" action="#{search.searchPo()}">
			<h:graphicImage class="glass_back" value="../img/glass.png" />
		</h:commandLink>
	</ui:define>

	<!-- Main content of  -->
	<ui:define name="maincontent">

		<!-- Grid for suppliers -->
		<div class="row table">
			<div class="col-sm-2 col-xs-2 heading supDetails">ID</div>
			<div class="col-sm-5 col-xs-5 heading supDetails">Supplier</div>
			<div class="col-sm-1 col-xs-1 heading supDetails listCenter">Products</div>
			<div class="col-sm-2 col-xs-2 heading supDetails listCenter">Total</div>
			<div class="col-sm-1 col-xs-1 heading supDetails listCenter">Delete</div>
			<div class="col-sm-1 col-xs-1 heading supDetails listCenter">Edit</div>
		</div>

		<!-- Generation of suppliers into grid -->
		<ui:repeat var="po" value="#{pos.dataModel}">
			<div class="row table listItem">
				<div class="col-sm-2 col-xs-2 supDetails">
					<h:form>
						<h:commandLink action="#{pos.view(po)}" value="#{po.id}" />
					</h:form>
				</div>
				<div class="col-sm-5 col-xs-5 supDetails">
					<h:form>
						<h:commandLink action="#{pos.view(po)}"
							value="#{po.supplier.company}" />
					</h:form>
				</div>
				<div class="col-sm-1 col-xs-1 supDetails listCenter">
					<h:form>
						<h:commandLink action="#{pos.view(po)}" value="#{po.lines.size()}" />
					</h:form>
				</div>
				<div class="col-sm-2 col-xs-2 supDetails listCenter">
				<h:form>
					<h:commandLink action="#{pos.view(po)}">
						<h:outputText value="#{pos.calculateTotal(po)}">
							<f:convertNumber pattern="Â£###,###,##0.00" />
						</h:outputText>
					</h:commandLink>
					</h:form>
				</div>
				<div class="col-sm-1 col-xs-1 prodDetails">
					<h:form>
						<button id="deleteButton" type="button"
							onclick="process(#{po.id})" data-toggle="modal"
							data-target="#myModal" />
					</h:form>
				</div>
				<div class="col-sm-1 col-xs-1 prodDetails">
					<h:form>
						<h:commandLink action="#{products.test(product.productID)}"
							value="" class="hovering">
							<h:graphicImage class="editorTools" value="../img/edit.png" />
						</h:commandLink>
					</h:form>
				</div>
			</div>
		</ui:repeat>


		<h:form>
			<div class="row">
				<div class="col-sm-4 col-xs-4 nbbuttonp pageing page">
					<h:commandLink action="#{pos.previous()}" value="Previous"
						rendered="#{pos.pagination.hasPreviousPage}" />
				</div>
				<div class="col-sm-4 col-xs-4 nbbuttonp pageing page">
					<h:outputText
						value="Showing POs #{pos.pagination.pageFirstItem + 1} to #{pos.pagination.getPageLastItem()} of #{pos.listData.size()}" />
				</div>
				<div class="col-sm-4 col-xs-4 nbbuttonp pageing page">
					<h:commandLink action="#{pos.next}"
						rendered="#{pos.pagination.hasNextPage}" value="Next" />
				</div>
			</div>
		</h:form>

		<div class="modal fade" id="myModal" tabindex="-1" role="dialog"
			aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"
							aria-label="Close">
							<span aria-hidden="true">X</span>
						</button>
						<h4 class="modal-title" id="myModalLabel">Confirm Purchase
							Order Delete</h4>
					</div>
					<div class="modal-body">Are you sure you want to delete this
						purchase order?</div>
					<div class="modal-footer">
						<button type="button" class="btn pull-left btn-danger"
							data-dismiss="modal">Cancel</button>
						<h:form id="formSubmission">
							<h:inputHidden id="id" value="#{button.idOfProduct}" />
							<h:commandLink class="btn btn-success" value="Confirm"
								type="submit" action="#{button.delete('')}" style="right:10px;" />
						</h:form>
					</div>
				</div>
			</div>
		</div>


		<script>
	function process(x) {
	     console.log(x);
	     document.getElementById("formSubmission:id").value = x;
	};
	</script>


	</ui:define>

	<!-- Add pagination here -->

</ui:composition>